<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Color Card Generator</title>

<!-- html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
    html, body {
        margin: 0;
        padding: 0;
        background: transparent;
    }

    body {
        font-family: Arial, sans-serif;
        padding: 40px;
    }

    .controls {
        margin-bottom: 20px;
    }

    .controls input {
        padding: 8px;
        font-size: 16px;
        width: 180px;
        margin-right: 10px;
    }

    button {
        padding: 8px 16px;
        font-size: 16px;
        margin-right: 5px;
    }

    #capture-area {
        display: inline-block;
        background: transparent;
    }

    .card {
        width: 350px;
        height: 160px;
        padding: 25px;
        border-radius: 25px;
        position: relative;
    }

    .label {
        position: absolute;
        bottom: 20px;
        left: 25px;
        font-weight: bold;
        font-size: 26px;
        line-height: 1.2em;
    }

    .code {
        font-size: 20px;
        opacity: 0.9;
    }
</style>
</head>

<body>

<div class="controls">
    <input id="labelInput" type="text" placeholder="ラベル名" value="CUSTOM COLOR">
    <input id="colorInput" type="text" placeholder="#RRGGBB" value="#B9ECFF">
    <button onclick="apply()">反映</button>
    <button onclick="downloadImage()">ダウンロード</button>
</div>

<div id="capture-area">
    <div id="card" class="card">
        <div class="label" id="label">
            <span id="labelText">CUSTOM COLOR</span><br>
            <span class="code" id="codeText">#B9ECFF</span>
        </div>
    </div>
</div>

<script>
function apply() {
    const labelText = document.getElementById("labelInput").value;
    const color = document.getElementById("colorInput").value;

    const card = document.getElementById("card");
    const label = document.getElementById("label");
    const labelSpan = document.getElementById("labelText");
    const codeSpan = document.getElementById("codeText");

    // 背景色
    card.style.background = color;

    // テキスト反映
    labelSpan.textContent = labelText;
    codeSpan.textContent = color.toUpperCase();

    // 明るさで文字色切り替え
    if (/^#([0-9A-F]{6})$/i.test(color)) {
        const r = parseInt(color.substr(1,2),16);
        const g = parseInt(color.substr(3,2),16);
        const b = parseInt(color.substr(5,2),16);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        label.style.color = brightness > 180 ? "#555" : "#fff";
    }
}

// 初期反映
apply();

function downloadImage() {
    html2canvas(document.getElementById("capture-area"), {
        backgroundColor: null,
        scale: 2
    }).then(canvas => {
        const link = document.createElement("a");
        link.href = canvas.toDataURL("image/png");
        link.download = "color-card.png";
        link.click();
    });
}
</script>

</body>
</html>
