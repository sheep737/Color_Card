<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>4 Color Cards Generator</title>

<!-- html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
    html, body {
        margin: 0;
        padding: 0;
        background: transparent;
    }

    body {
        font-family: Arial, sans-serif;
        padding: 40px;
    }

    .controls {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
        margin-bottom: 30px;
    }

    .control {
        border: 1px solid #ddd;
        padding: 10px;
        border-radius: 8px;
    }

    .control h3 {
        margin: 0 0 8px;
        font-size: 16px;
    }

    .control input {
        width: 100%;
        padding: 6px;
        margin-bottom: 6px;
        font-size: 14px;
    }

    button {
        padding: 10px 18px;
        font-size: 16px;
        margin-bottom: 30px;
    }

    #capture-area {
        display: inline-block;
        background: transparent;
    }

    .card {
        width: 350px;
        height: 160px;
        padding: 25px;
        border-radius: 25px;
        margin-bottom: 30px;
        position: relative;
    }

    .label {
        position: absolute;
        bottom: 20px;
        left: 25px;
        font-weight: bold;
        font-size: 26px;
        line-height: 1.2em;
    }

    .code {
        font-size: 20px;
        opacity: 0.9;
    }
</style>
</head>

<body>
<div>ver:4</div>
<div class="controls">
    <div class="control">
        <h3>Card 1</h3>
        <input id="label1" value="MINT GREEN">
        <input id="color1" value="#B9ECFF">
    </div>

    <div class="control">
        <h3>Card 2</h3>
        <input id="label2" value="SILVER GREEN">
        <input id="color2" value="#A8D8FF">
    </div>

    <div class="control">
        <h3>Card 3</h3>
        <input id="label3" value="PINK">
        <input id="color3" value="#FFD0EC">
    </div>

    <div class="control">
        <h3>Card 4</h3>
        <input id="label4" value="WHITE">
        <input id="color4" value="#FFFFFF">
    </div>
</div>

<button onclick="applyAll()">反映</button>
<button onclick="downloadImage()">画像をダウンロード</button>

<div id="capture-area">
    <div id="card1" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
    <div id="card2" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
    <div id="card3" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
    <div id="card4" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
</div>

<script>

const COLOR_NAMES = [
  { name: "White", rgb: [255,255,255] },
  { name: "Ivory", rgb: [255,255,240] },
  { name: "Snow", rgb: [255,250,250] },

  { name: "Black", rgb: [0,0,0] },
  { name: "Charcoal", rgb: [54,69,79] },

  { name: "Light Gray", rgb: [211,211,211] },
  { name: "Silver", rgb: [192,192,192] },

  { name: "Mint Green", rgb: [189,252,201] },
  { name: "Seafoam Green", rgb: [159,226,191] },
  { name: "Aqua Green", rgb: [127,255,212] },

  { name: "Sky Blue", rgb: [135,206,235] },
  { name: "Baby Blue", rgb: [137,207,240] },
  { name: "Light Blue", rgb: [173,216,230] },
  { name: "Powder Blue", rgb: [176,224,230] },

  { name: "Lavender", rgb: [230,230,250] },
  { name: "Lilac", rgb: [200,162,200] },

  { name: "Soft Pink", rgb: [255,192,203] },
  { name: "Rose Pink", rgb: [255,182,193] },
  { name: "Hot Pink", rgb: [255,105,180] },

  { name: "Peach", rgb: [255,218,185] },
  { name: "Coral", rgb: [255,127,80] },

  { name: "Beige", rgb: [245,245,220] },
  { name: "Sand", rgb: [244,164,96] }
];
    
function applyCard(i) {
    const colorInput = document.getElementById("color" + i);
    const labelInput = document.getElementById("label" + i);

    const color = colorInput.value;
    const card = document.getElementById("card" + i);
    const labelDiv = card.querySelector(".label");
    const spans = labelDiv.querySelectorAll("span");

    // ★ 色名を自動生成
    const autoName = getClosestColorName(color);
    if (autoName) {
        labelInput.value = autoName.toUpperCase();
    }

    card.style.background = color;
    spans[0].textContent = labelInput.value;
    spans[1].textContent = color.toUpperCase();

    // 明るさで文字色切り替え
    if (/^#([0-9A-F]{6})$/i.test(color)) {
        const [r,g,b] = hexToRgb(color);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        labelDiv.style.color = brightness > 180 ? "#555" : "#fff";
    }
}

function applyAll() {
    for (let i = 1; i <= 4; i++) {
        applyCard(i);
    }
}

// 初期反映
applyAll();

function downloadImage() {
    html2canvas(document.getElementById("capture-area"), {
        backgroundColor: null,
        scale: 2
    }).then(canvas => {
        canvas.toBlob(blob => {
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = "color-cards.png";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        });
    });
}

function hexToRgb(hex) {
  hex = hex.replace("#", "");
  return [
    parseInt(hex.substring(0,2),16),
    parseInt(hex.substring(2,4),16),
    parseInt(hex.substring(4,6),16)
  ];
}

function getClosestColorName(hex) {
  if (!/^#([0-9A-F]{6})$/i.test(hex)) return "";

  const [r,g,b] = hexToRgb(hex);
  let closest = null;
  let minDistance = Infinity;

  COLOR_NAMES.forEach(c => {
    const dr = r - c.rgb[0];
    const dg = g - c.rgb[1];
    const db = b - c.rgb[2];
    const distance = dr*dr + dg*dg + db*db;

    if (distance < minDistance) {
      minDistance = distance;
      closest = c.name;
    }
  });

  return closest;
}
    
</script>

</body>
</html>
